!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};e=a("./preview"),d=a("./events"),b.exports=c=function(){function a(a){var b,c,d,g;this.arena=a.arena,this.view=a.view,this.img=a.img,this.outline=a.outline,d=a.url,this.fixedWidth=a.fixedWidth,this.fixedHeight=a.fixedHeight,this.minViewWidth=a.minViewWidth,this.minViewHeight=a.minViewHeight,this.minViewRatio=a.minViewRatio,this.maxViewRatio=a.maxViewRatio,b=a.crop,g=a.zoomStep,c=a.maxArea,this.actions=a.actions,this.onPreviewReady=f(this.onPreviewReady,this),this.loadingCssClass="crop-view--is-loading",this.panningCssClass="crop-view--is-panning",this.outlineCssClass="crop-outline--active",this.isPanning=!1,this.initialCrop=b,this.readyEvent=$.Callbacks("memory once"),this.loadEvent=$.Callbacks(),this.changeEvent=$.Callbacks(),this.zoomInStep=g,this.zoomOutStep=1/this.zoomInStep,this.arenaWidth=this.arena.width(),this.arenaHeight=this.arena.height(),c&&(this.maxArea=this.arenaWidth*this.arenaHeight*c),this.preview=new e({onReady:this.onPreviewReady,img:this.img,outline:this.outline}),this.setImage(d)}return a.prototype.setImage=function(a){return a!==this.preview.url?(this.isInitialized&&this.preview.reset(),this.isReady=!1,this.view.addClass(this.loadingCssClass),this.preview.setImage({url:a})):void 0},a.prototype.reset=function(){return this.isReady?(this.resize({width:this.imageWidth,height:this.imageHeight}),this.zoomAllOut()):void 0},a.prototype.onPreviewReady=function(a){var b,c,e;return e=a.width,b=a.height,this.isInitialized||(this.events=new d({parent:this,view:this.view,actions:this.actions})),this.imageWidth=e,this.imageHeight=b,this.imageRatio=this.imageWidth/this.imageHeight,this.calcMaxMinDimensions(),this.fixedWidth&&(c="width"),this.fixedHeight&&(c="height"),this.setViewDimensions({width:this.imageWidth,height:this.imageHeight,keepDimension:c}),this.isReady=!0,this.view.removeClass(this.loadingCssClass),this.isInitialized||null==this.initialCrop?(this.zoomAllOut(),this.center()):this.setCrop(this.initialCrop),this.isInitialized=!0,this.readyEvent.fire(),this.loadEvent.fire()},a.prototype.setCrop=function(a){var b,c,d,e,f,g;return f=a.x,g=a.y,e=a.width,c=a.height,this.isReady?(this.resize({width:e,height:c}),b=this.viewWidth/e,d=this.imageWidth*b,this.zoom({width:d}),this.pan({x:f*b,y:g*b})):void this.on("ready",function(a){return function(){return a.setCrop({x:f,y:g,width:e,height:c})}}(this))},a.prototype.getCrop=function(){var a,b;return b=this.preview.width/this.imageWidth,a={x:this.preview.x/b,y:this.preview.y/b,width:this.viewWidth/b,height:this.viewHeight/b},this.roundCrop(a),this.validateCrop(a),a},a.prototype.roundCrop=function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(a[b]=Math.round(c));return d},a.prototype.validateCrop=function(a){var b,c,d,e;return d=a.x,e=a.y,c=a.width,b=a.height,d+c>this.imageWidth?a.width=this.imageWidth-d:e+b>this.imageHeight&&(a.height=this.imageHeight-e),a},a.prototype.setRatio=function(a,b){var c,d;return this.isReady?(a=this.enforceValidRatio(a),"height"===b?(c=this.viewHeight,d=c*a):(d=this.viewWidth,c=d/a),this.resizeFocusPoint=this.getFocusPoint(),this.resize({width:d,height:c})):void this.on("ready",function(c){return function(){return c.setRatio({ratio:a,keepDimension:b})}}(this))},a.prototype.onPan=function(a){var b,c;return this.isPanning||(this.isPanning=!0,this.arena.addClass(this.panningCssClass),this.outline.addClass(this.outlineCssClass)),b=a.startX-a.dx,c=a.startY-a.dy,this.pan({x:b,y:c})},a.prototype.onPanEnd=function(){return this.isPanning=!1,this.arena.removeClass(this.panningCssClass),this.outline.removeClass(this.outlineCssClass)},a.prototype.onDoubleClick=function(a){var b,c,d,e,f,g,h;return c=a.pageX,d=a.pageY,h=this.view[0].getBoundingClientRect(),b=h.left,e=h.top,f=c-b,g=d-e,this.zoomIn({viewX:f,viewY:g})},a.prototype.onResize=function(a){var b,c,d;return d=a.position,b=a.dx,c=a.dy,this.isResizing||(this.isResizing=!0,this.resizeFocusPoint=this.getFocusPoint()),"top"===d||"bottom"===d?(c=2*c,this.resize({width:this.viewWidth,height:this.viewHeight+c,keepDimension:"height"})):"left"===d||"right"===d?(b=2*b,this.resize({width:this.viewWidth+b,height:this.viewHeight,keepDimension:"width"})):void 0},a.prototype.onResizeEnd=function(){return this.isResizing=!1,this.resizeFocusPoint=void 0},a.prototype.resize=function(a){var b,c,d;return d=a.width,b=a.height,c=a.keepDimension,this.setViewDimensions({width:d,height:b,keepDimension:c}),this.resizeFocusPoint&&(this.resizeFocusPoint.viewX=this.viewWidth/2,this.resizeFocusPoint.viewY=this.viewHeight/2),this.zoom({width:this.preview.width,height:this.preview.height,focusPoint:this.resizeFocusPoint})},a.prototype.setViewDimensions=function(a){var b,c,d,e,f;return d=a.width,b=a.height,c=a.keepDimension,this.maxArea&&(e=this.enforceMaxArea({width:d,height:b,keepDimension:c}),d=e.width,b=e.height),f=this.enforceViewDimensions({width:d,height:b,keepDimension:c}),d=f.width,b=f.height,this.view.css({width:d,height:b}),this.viewWidth=d,this.viewHeight=b,this.viewRatio=d/b,this.fireChange()},a.prototype.zoomAllOut=function(){return this.zoom(this.isWidthRestricting()?{width:this.viewWidth}:{height:this.viewHeight})},a.prototype.zoomIn=function(a){return null==a&&(a={}),this.isWidthRestricting()?a.width=this.preview.width*this.zoomInStep:a.height=this.preview.height*this.zoomInStep,this.zoom(a)},a.prototype.zoomOut=function(a){return null==a&&(a={}),this.isWidthRestricting()?a.width=this.preview.width*this.zoomOutStep:a.height=this.preview.height*this.zoomOutStep,this.zoom(a)},a.prototype.zoom=function(a){var b,c,d,e,f,g;return f=a.width,c=a.height,d=a.viewX,e=a.viewY,b=a.focusPoint,null==b&&(b=this.getFocusPoint({viewX:d,viewY:e})),g=this.enforceZoom({width:f,height:c}),f=g.width,c=g.height,null!=f?(this.preview.setWidth(f),this.fireChange()):null!=c&&(this.preview.setHeight(c),this.fireChange()),this.focus(b)},a.prototype.getFocusPoint=function(a){var b,c,d,e,f,g,h;return h=null!=a?a:{},d=h.viewX,e=h.viewY,null==d&&(d=this.viewWidth/2),null==e&&(e=this.viewHeight/2),f=this.preview.x+d,g=this.preview.y+e,b=f/this.preview.width,c=g/this.preview.height,{percentX:b,percentY:c,viewX:d,viewY:e}},a.prototype.focus=function(a){var b,c,d,e,f,g;return b=a.percentX,c=a.percentY,d=a.viewX,e=a.viewY,f=this.preview.width*b,g=this.preview.height*c,f-=d,g-=e,this.pan({x:f,y:g})},a.prototype.center=function(){var a,b;return a=(this.preview.width-this.viewWidth)/2,b=(this.preview.height-this.viewHeight)/2,this.pan({x:a,y:b})},a.prototype.pan=function(a){return a=this.enforceXy(a),this.preview.pan(a.x,a.y),this.fireChange()},a.prototype.enforceXy=function(a){var b,c;return b=a.x,c=a.y,0>b?b=0:b>this.preview.width-this.viewWidth&&(b=this.preview.width-this.viewWidth),0>c?c=0:c>this.preview.height-this.viewHeight&&(c=this.preview.height-this.viewHeight),{x:b,y:c}},a.prototype.enforceZoom=function(a){var b,c;if(c=a.width,b=a.height,null!=c){if(c>this.imageWidth)return{width:this.imageWidth};if(c<this.viewWidth)return{width:this.viewWidth}}if(null!=b){if(b>this.imageHeight)return{height:this.imageHeight};if(b<this.viewHeight)return{height:this.viewHeight}}return{width:c,height:b}},a.prototype.calcMaxMinDimensions=function(){return this.maxWidth=this.min([this.arenaWidth,this.imageWidth]),this.maxHeight=this.min([this.arenaHeight,this.imageHeight]),this.minWidth=this.minViewWidth||0,this.minHeight=this.minViewHeight||0,this.fixedWidth&&(this.maxWidth=this.minWidth=this.fixedWidth),this.fixedHeight?this.maxHeight=this.minHeight=this.fixedHeight:void 0},a.prototype.areDimensionsValid=function(a){var b,c,d,e,f;return f=a.width,b=a.height,d=a.keepDimension,e=f/b,c=f<this.minWidth||f>this.maxWidth||b<this.minHeight||b>this.maxHeight||e<this.minViewRatio||e>this.maxViewRatio,!c},a.prototype.isValidRatio=function(a){return!(a<this.minViewRatio||a>this.maxViewRatio)},a.prototype.enforceValidRatio=function(a){return a<this.minViewRatio?this.minViewRatio:a>this.maxViewRatio?this.maxViewRatio:a},a.prototype.enforceViewDimensions=function(a){var b,c,d,e,f,g,h,i,j;return g=a.width,b=a.height,c=a.keepDimension,g<this.minWidth&&(e=this.minWidth),g>this.maxWidth&&(e=this.maxWidth),b<this.minHeight&&(d=this.minHeight),b>this.maxHeight&&(d=this.maxHeight),c?(e&&(g=e),d&&(b=d),f=g/b,this.isValidRatio(f)||(f=this.enforceValidRatio(f),h=this.getRatioBox({ratio:f,width:g,height:b,keepDimension:c}),g=h.width,b=h.height,i=this.centerAlign(this.maxWidth,this.maxHeight,f),g=i.width,b=i.height)):(e||d)&&(f=this.enforceValidRatio(g/b),j=this.centerAlign(this.maxWidth,this.maxHeight,f),g=j.width,b=j.height),{width:g,height:b}},a.prototype.enforceMaxArea=function(a){var b,c,d,e;return e=a.width,b=a.height,c=a.keepDimension,d=e/b,"width"===c?(b=this.maxArea/e,d=e/b):"height"===c?(e=this.maxArea/b,d=e/b):(e=Math.sqrt(this.maxArea*d),b=e/d),this.isValidRatio(d)||(d=this.enforceValidRatio(d),e=Math.sqrt(this.maxArea*d),b=e/d),{width:e,height:b}},a.prototype.isWidthRestricting=function(){return this.viewRatio>=this.imageRatio},a.prototype.getRatioBox=function(a){var b,c,d,e;return d=a.ratio,e=a.width,b=a.height,c=a.keepDimension,"width"===c||null==b?b=e/d:"height"===c||null==e?e=b*d:b=e/d,{width:e,height:b}},a.prototype.centerAlign=function(a,b,c){var d,e,f,g;return a/b>c?(e=b*c,f=(a-e)/2):(d=a/c,g=(b-d)/2),{x:f||0,y:g||0,width:e||a,height:d||b}},a.prototype.min=function(a){var b,c,d,e;for(b=a[0],d=0,e=a.length;e>d;d++)c=a[d],b>c&&(b=c);return b},a.prototype.on=function(a,b){return this[a+"Event"].add(b)},a.prototype.off=function(a,b){return this[a+"Event"].remove(b)},a.prototype.fireChange=function(){return null==this.changeDispatch?this.changeDispatch=setTimeout(function(a){return function(){return a.changeDispatch=void 0,a.changeEvent.fire(a.getCrop())}}(this),0):void 0},a.prototype.debug=function(){var a,b;return b=function(a){return Math.round(10*a)/10},a={arena:b(this.arenaWidth)+"x"+b(this.arenaHeight),view:b(this.viewWidth)+"x"+b(this.viewHeight),image:b(this.imageWidth)+"x"+b(this.imageHeight),preview:b(this.preview.width)+"x"+b(this.preview.height),previewXy:b(this.preview.x)+"x"+b(this.preview.y)},console.log(a),a},a}()},{"./events":2,"./preview":3}],2:[function(a,b){var c;b.exports=c=function(){function a(a){var b,c,d;this.parent=a.parent,this.view=a.view,c=a.horizontal,d=a.vertical,b=a.actions,this.doubleClickThreshold=300,b.pan&&this.pan(),b.zoomOnDoubleClick&&this.doubleClick(),b.resize&&this.resizeView({horizontal:b.resizeHorizontal,vertical:b.resizeVertical}),this.preventBrowserDragDrop(),this.responsiveArena()}return a.prototype.pan=function(){var a;return a=$(document),this.view.on("mousedown.srcissors",function(b){return function(c){var d;return d={startX:b.parent.preview.x,startY:b.parent.preview.y},c.preventDefault(),a.on("mousemove.srcissors-pan",function(a){return d.dx=a.pageX-c.pageX,d.dy=a.pageY-c.pageY,b.parent.onPan(d)}).on("mouseup.srcissors-pan",function(){return a.off("mouseup.srcissors-pan"),a.off("mousemove.srcissors-pan"),null!=d.dx?b.parent.onPanEnd():void 0})}}(this))},a.prototype.doubleClick=function(){var a;return a=void 0,this.view.on("mousedown.srcissors",function(b){return function(c){var d;return d=(new Date).getTime(),a&&a>d-b.doubleClickThreshold&&b.parent.onDoubleClick({pageX:c.pageX,pageY:c.pageY}),a=d}}(this))},a.prototype.preventBrowserDragDrop=function(){return this.view.on("dragstart.srcissors",function(){return!1})},a.prototype.resizeView=function(a){var b,c,d,e;return c=a.horizontal,e=a.vertical,b=$("<div>"),b.addClass("resize-handler"),d=[],c&&(d=d.concat(["right","left"])),e&&(d=d.concat(["top","bottom"])),d.forEach(function(a){return function(c){var d;return d=b.clone(),d.addClass("resize-handler-"+c),d.on("mousedown.srcissors",a.getResizeMouseDown(c)),a.view.append(d)}}(this))},a.prototype.getResizeMouseDown=function(a){var b;return b=$(document),function(c){return function(d){var e,f;return e=d.pageX,f=d.pageY,d.stopPropagation(),b.on("mousemove.srcissors-resize",function(b){var d,g;switch(a){case"top":case"bottom":g=b.pageY-f,"top"===a&&(g=-g),f=b.pageY;break;case"left":case"right":d=b.pageX-e,"left"===a&&(d=-d),e=b.pageX}return c.parent.onResize({position:a,dx:d,dy:g})}).on("mouseup.srcissors-resize",function(){return b.off("mouseup.srcissors-resize"),b.off("mousemove.srcissors-resize"),c.parent.onResizeEnd({position:a})})}}(this)},a.prototype.responsiveArena=function(){},a}()},{}],3:[function(a,b){var c;b.exports=c=function(){function a(a){this.onReady=a.onReady,this.img=a.img,this.outline=a.outline,this.x=this.y=0,this.width=this.height=0,this.img.on("load",function(a){return function(){var b,c;return c=a.img.width(),b=a.img.height(),a.ratio=c/b,a.updateImageDimensions({width:c,height:b}),a.onReady({width:a.width,height:a.height}),a.img.show()}}(this))}return a.prototype.setImage=function(a){return this.url=a.url,this.img.attr("src",this.url)},a.prototype.reset=function(){return this.url=void 0,this.x=this.y=0,this.width=this.height=0,this.img.attr("src",""),this.img.css({width:"",height:"",transform:""}),this.outline?this.outline.css({transform:""}):void 0},a.prototype.setWidth=function(a){var b;return this.img.css({width:a+"px",height:"auto"}),b=a/this.ratio,this.updateImageDimensions({width:a,height:b})},a.prototype.setHeight=function(a){var b;return this.img.css({width:"auto",height:a+"px"}),b=a*this.ratio,this.updateImageDimensions({width:b,height:a})},a.prototype.updateImageDimensions=function(a){var b,c;return c=a.width,b=a.height,this.width=c,this.height=b,this.outline?this.outline.css({width:this.width+"px",height:this.height+"px"}):void 0},a.prototype.pan=function(a,b){var c,d;return this.x=a,this.y=b,c=Math.round(this.x),d=Math.round(this.y),this.img.css({transform:"translate(-"+c+"px, -"+d+"px)"}),this.outline?this.outline.css({transform:"translate(-"+c+"px, -"+d+"px)"}):void 0},a}()},{}],4:[function(a,b){var c;c=a("./crop"),b.exports=window.srcissors={"new":function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;return e=a.arena,q=a.url,h=a.fixedWidth,g=a.fixedHeight,n=a.minWidth,l=a.minHeight,m=a.minRatio,k=a.maxRatio,j=a.maxArea,s=a.zoomStep,f=a.crop,b=a.actions,e=$(e),r=e.find(".crop-view"),p=r.find(".crop-preview"),i=$("<img>"),p.append(i),o=r.find(".crop-outline"),o.length||(o=void 0),d={pan:!0,zoomOnDoubleClick:!0,resize:!0,resizeHorizontal:!h,resizeVertical:!g},$.extend(d,b),null==s&&(s=1.25),null==n&&(n=50),null==l&&(l=50),new c({url:q,crop:f,arena:e,view:r,img:i,outline:o,fixedWidth:h,fixedHeight:g,minViewWidth:n,minViewHeight:l,minViewRatio:m,maxViewRatio:k,maxArea:j,zoomStep:s,actions:d})}}},{"./crop":1}]},{},[4]);